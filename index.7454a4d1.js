!function(){var t=Object.freeze({Start:"start",Restart:"restart",Hidden:"hidden",ActionButton:"button"}),e=Object.freeze({Start:"Start",Restart:"Restart"}),s={};function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var i=function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:structuredClone(e.DEFAULT_BOARD),s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.START_TILES_QUANTITY_DEFAULT;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),r(this,"status",e.STATUS.Idle),r(this,"score",0),this.state=t,this.startTilesAmount=s}return t=[{key:"size",get:function(){return this.state.length}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"move",value:function(t){switch(t){case"ArrowUp":this.moveUp();break;case"ArrowRight":this.moveRight();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft()}this.placeNewTile(),this.updateGameStatus()}},{key:"handleMove",value:function(){for(var t=0;t<this.size;t++){for(var e=[],s=0;s<this.size;s++)0!==this.state[s][t]&&e.push(this.state[s][t]);for(var r=[],i=0;i<e.length;)if(i+1<e.length&&e[i]===e[i+1]){var o=2*e[i];r.push(o),this.score+=o,i+=2}else r.push(e[i]),i++;for(;r.length<this.size;)r.push(0);for(var a=0;a<this.size;a++)this.state[a][t]=r[a]}}},{key:"moveUp",value:function(){this.handleMove()}},{key:"moveDown",value:function(){this.reverseGrid(),this.handleMove(),this.reverseGrid()}},{key:"moveLeft",value:function(){this.rotateClockwise(),this.handleMove(),this.rotateCounterClockwise()}},{key:"moveRight",value:function(){this.rotateCounterClockwise(),this.handleMove(),this.rotateClockwise()}},{key:"reverseGrid",value:function(){this.state.reverse()}},{key:"transpose",value:function(){for(var t,e=0;e<this.size;e++)for(var s=e+1;s<this.size;s++)t=[this.state[s][e],this.state[e][s]],this.state[e][s]=t[0],this.state[s][e]=t[1]}},{key:"rotateClockwise",value:function(){this.transpose(),this.state.forEach(function(t){return t.reverse()})}},{key:"rotateCounterClockwise",value:function(){this.state.forEach(function(t){return t.reverse()}),this.transpose()}},{key:"updateGameStatus",value:function(){if(!this.checkMovePossibility()){this.status=e.STATUS.Lost;var t=!0,s=!1,r=void 0;try{for(var i,o=this.state[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)if(i.value.includes(2048)){this.status=e.STATUS.Won;return}}catch(t){s=!0,r=t}finally{try{t||null==o.return||o.return()}finally{if(s)throw r}}}}},{key:"start",value:function(){this.status=e.STATUS.Playing;for(var t=0;t<this.startTilesAmount;t++)this.placeNewTile()}},{key:"restart",value:function(){this.status=e.STATUS.Idle,this.state=structuredClone(e.DEFAULT_BOARD),this.score=0,this.start()}},{key:"getTwoOrFour",value:function(){return .9>Math.random()?2:4}},{key:"placeNewTile",value:function(){for(var t=[],e=0;e<this.size;e++)for(var s=0;s<this.size;s++)0===this.state[e][s]&&t.push({row:e,col:s});if(t.length>0){var r=Math.floor(Math.random()*t.length),i=t[r],o=i.row,a=i.col;this.state[o][a]=this.getTwoOrFour()}}},{key:"checkMovePossibility",value:function(){for(var t=0;t<this.size;t++)for(var e=0;e<this.size;e++)if(0===this.state[t][e])return!0;for(var s=0;s<this.size;s++)for(var r=0;r<this.size-1;r++)if(this.state[s][r]===this.state[s][r+1])return!0;for(var i=0;i<this.size;i++)for(var o=0;o<this.size-1;o++)if(this.state[o][i]===this.state[o+1][i])return!0;return!1}}],function(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(e.prototype,t),e}();r(i,"START_TILES_QUANTITY_DEFAULT",2),r(i,"DEFAULT_BOARD",[,,,,].fill().map(function(){return[,,,,].fill(0)})),r(i,"MOVE_KEYS",Object.freeze(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"])),r(i,"STATUS",Object.freeze({Idle:"Idle",Playing:"Playing",Lost:"Lost",Won:"Won"}));var o=new(s=i),a=document.querySelector(".container"),n=a.querySelector(".controls button"),l=a.querySelector(".controls .info"),u=a.querySelector(".controls .game-score"),c=a.querySelector(".game-field tbody"),h=a.querySelector(".message-start"),f=a.querySelector(".message-win"),v=a.querySelector(".message-lose");function d(){u.textContent=o.getScore(),function(){for(var t=o.getState(),e=c.rows.length,s=c.rows[0].cells.length,r=0;r<e;r++)for(var i=0;i<s;i++){var a=c.rows[r].cells[i],n=t[r][i];a.textContent=n||"",a.className="field-cell ".concat(n?"field-cell--".concat(n):"")}}(),function(){var r=o.getStatus(),i=r===s.STATUS.Idle;switch(h.classList.add(t.Hidden),f.classList.add(t.Hidden),v.classList.add(t.Hidden),n.classList.remove(t.Restart,t.Start),n.classList.add(i?t.Start:t.Restart),n.textContent=i?e.Start:e.Restart,r){case s.STATUS.Won:f.classList.remove(t.Hidden);break;case s.STATUS.Lost:v.classList.remove(t.Hidden)}}()}document.addEventListener("keydown",function(t){s.MOVE_KEYS.includes(t.key)&&(t.preventDefault(),o.move(t.key),d())}),n.addEventListener("click",function(){o.getStatus()===s.STATUS.Idle?o.start():o.restart(),d()}),l.addEventListener("click",function(){console.log(o.getScore())})}();
//# sourceMappingURL=index.7454a4d1.js.map
